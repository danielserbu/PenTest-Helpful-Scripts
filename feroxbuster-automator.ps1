$domains_to_scan = @("todo.todo.com")

$wordlists = @(
    "/usr/share/seclists/Discovery/Web-Content/quickhits.txt",
    "/usr/share/seclists/Discovery/Web-Content/common.txt",
    "/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt",
    "/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt"
)

foreach ($domain in $domains_to_scan) {
    $host_ip = $domain -replace 'https://'

    for ($i = 0; $i -lt $wordlists.Count; $i++) {
        $output_file = "scan_${i}_${host_ip}.txt"
        $feroxbusterArgs = "-u $domain -w $($wordlists[$i]) -o $output_file -k"
        Start-Process "feroxbuster" -ArgumentList $feroxbusterArgs -Wait -NoNewWindow
    }
}

Get-ChildItem -Filter "scan_*_${host_ip}.txt" | ForEach-Object {
    $content = Get-Content $_.FullName
    $content | Where-Object { $_ -match '200\s+GET' } | Out-File "feroxbuster_200_return_codes.txt" -Append
    $content | Where-Object { $_ -match '401\s+GET' } | Out-File "feroxbuster_401_return_codes.txt" -Append
    $content | Where-Object { $_ -match '403\s+GET' } | Out-File "feroxbuster_403_return_codes.txt" -Append
}