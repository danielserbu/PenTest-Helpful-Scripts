import socket
import argparse

parser = argparse.ArgumentParser(description="FQDN resolver from IP addresses file.")
parser.add_argument("-iF", "--ipAddressesFile", help="IP Addresses file (separated by new line")
args = parser.parse_args()
ipAddressesFile = args.ipAddressesFile
ip_addresses = open(ipAddressesFile).read().splitlines()

fqdns_list = []
for ip in ip_addresses:
    host = socket.gethostbyaddr(ip)
    fqdns_list.append(host[0])

output_file = "resolvedFQDNsOutput.txt"

with open(output_file, "w") as file:
    for fqdn in fqdns_list:
        file.writelines(fqdn + '\n')