import socket
import argparse

parser = argparse.ArgumentParser(description="FQDN resolver from IP addresses file.")
parser.add_argument("-iF", "--ipAddressesFile", help="IP Addresses file (separated by new line)")
args = parser.parse_args()
ipAddressesFile = args.ipAddressesFile
ip_addresses = open(ipAddressesFile).read().splitlines()

fqdns_dict = {}
for ip in ip_addresses:
    try:
        host = socket.gethostbyaddr(ip)
        fqdns_dict[ip] = host[0]
    except socket.herror as e:
        fqdns_dict[ip] = f"Unable to resolve hostname. Error: {e}"

output_file = "resolvedFQDNsOutput.txt"

with open(output_file, "w") as file:
    for ip, fqdn in fqdns_dict.items():
        file.writelines(f"{ip}:{fqdn}\n")
