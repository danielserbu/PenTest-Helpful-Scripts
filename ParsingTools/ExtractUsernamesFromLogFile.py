import re
import sys

def extract_usernames_from_log(log_file_path, output_file_path, username_pattern):
    usernames = set()

    with open(log_file_path, "r", encoding="utf-8") as log_file:
        for line in log_file:
            match = re.search(username_pattern, line)
            if match:
                username = match.group(1)
                usernames.add(username)

    with open(output_file_path, "w", encoding="utf-8") as output_file:
        for username in usernames:
            output_file.write(f"{username}\n")

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python ExtractUsernamesFromLogFile.py <log_file_path> <output_file_path> <username_pattern>")
        sys.exit(1)

    log_file_path = sys.argv[1]
    output_file_path = sys.argv[2]
    username_pattern = sys.argv[3]
    extract_usernames_from_log(log_file_path, output_file_path, username_pattern)


# Example
# python ExtractUsernamesFromLogFile.py log.log ExtractedUsernames.txt "Failed password for (\S+)"